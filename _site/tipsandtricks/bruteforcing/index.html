<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Brute Forcing Logins and Passwords | Wesley Kent</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Brute Forcing Logins and Passwords" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Using tools like Hydra, John, and Burpsuite" />
<meta property="og:description" content="Using tools like Hydra, John, and Burpsuite" />
<link rel="canonical" href="http://localhost:4000/tipsandtricks/bruteforcing/" />
<meta property="og:url" content="http://localhost:4000/tipsandtricks/bruteforcing/" />
<meta property="og:site_name" content="Wesley Kent" />
<meta property="og:image" content="http://localhost:4000/home/wesleyvm1/WesleyKentBlog/assets/fe.ico" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/home/wesleyvm1/WesleyKentBlog/assets/fe.ico" />
<meta property="twitter:title" content="Brute Forcing Logins and Passwords" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Using tools like Hydra, John, and Burpsuite","headline":"Brute Forcing Logins and Passwords","image":"http://localhost:4000/home/wesleyvm1/WesleyKentBlog/assets/fe.ico","url":"http://localhost:4000/tipsandtricks/bruteforcing/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                Wesley Kent
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">CTF Exploits</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/tipsandtricks/" class="navbar-link is-active">Tips and Tricks</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/tipsandtricks/bruteforcing/" class="navbar-item is-active">Brute forcing</a>
                            
                            <a href="/tipsandtricks/privilegeescalation/" class="navbar-item ">Privilege Escalation</a>
                            
                            <a href="/tipsandtricks/webstuff/" class="navbar-item ">Web Stuff</a>
                            
                            <a href="/tipsandtricks/usingnmap/" class="navbar-item ">Using Nmap</a>
                            
                            <a href="/tipsandtricks/steganography/" class="navbar-item ">Steganography</a>
                            
                            <a href="/tipsandtricks/defaultpayloads/" class="navbar-item ">Default payloads and msfconsole</a>
                            
                            <a href="/tipsandtricks/thebasics/" class="navbar-item ">The Basics</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/resources/" class="navbar-link ">Resources</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/resources/usefullinks" class="navbar-item ">Useful links</a>
                            
                            <a href="/resources/freshinstall" class="navbar-item ">Fresh Install</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/raspberrypi/" class="navbar-item ">Raspberry Pi Projects</a>
                    
                
                    
                    <a href="/femoldark/" class="navbar-item ">FE Moldark</a>
                    
                
                    
                    <a href="/contact/" class="navbar-item ">Contact</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-medium  is-bold is-primary" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">Brute Forcing Logins and Passwords</h1>
            <p class="subtitle is-3">Using tools like Hydra, John, and Burpsuite</p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-12">
                    
                    
                    
                    
                    
<div class="content">
    <h2 id="hydra-for-cracking-online-web-portals-ssh-and-ftp-ports">Hydra for cracking online web portals, ssh and ftp ports</h2>
<p><br />
For this section I’ll cover two examples using hydra - both will be instances I’ve used in exploits from various CTFs<br /><br />
First, some of the basic flags used with hydra:<br /></p>
<ul>
  <li>You need a username: <code class="language-plaintext highlighter-rouge">-l admin</code> for a single username OR <code class="language-plaintext highlighter-rouge">-L usernamelist.txt</code> for a list of possible usernames</li>
  <li>You need a password to run against the username(s): <code class="language-plaintext highlighter-rouge">-p aSinglePassword</code> OR <code class="language-plaintext highlighter-rouge">-P /usr/share/wordlists/rockyou.txt</code>  the latter being more likely</li>
  <li>You need the IP address you are targeting, for example: <code class="language-plaintext highlighter-rouge">10.10.188.175</code></li>
  <li>If you need to designate a non-default port: <code class="language-plaintext highlighter-rouge">-s [port#]</code></li>
  <li>The <em>type</em> of attack, examples include: <code class="language-plaintext highlighter-rouge">http-post-form</code>, <code class="language-plaintext highlighter-rouge">ssh</code>, or <code class="language-plaintext highlighter-rouge">ftp</code>, to name but a few</li>
  <li>If it is an <code class="language-plaintext highlighter-rouge">http-post-form</code> you will need to designate either a (for example) <code class="language-plaintext highlighter-rouge">:S=302</code> indicating a redirect which might be a good sign, or a <code class="language-plaintext highlighter-rouge">:F=failed</code> which would designate a failed login attempt (i.e. ignore).</li>
  <li>Another part you will need for the web logins specifically is the actual request, which is obtained with burpsuite and get into that down below</li>
  <li>There are many more flags you can include, but these should be enougshould get you started.
<br /><br /><br /></li>
</ul>

<h4 id="example-using-hydra-against-a-web-portal">Example: Using hydra against a web portal</h4>
<p>This was a Mr. Robot themed CTF if I recall correctly, anyway hopefully seeing all this put together makes more sense:<br />
After running gobuster to enumerate their web server I found their login portal at “/wp-login”. From there I used burpsuite to capture the request:<br />
<br /><img src="/assets/burp1.jpg" alt="" /><br /><br />
I replaced my test inputs of “testuser” and “testpw” with the appropriate <code class="language-plaintext highlighter-rouge">^USER^</code> and <code class="language-plaintext highlighter-rouge">^PASS^</code> notation, and at the end of that added that a success means a 302 redirect, since that means I am being logged in and forwarded elsewhere: <code class="language-plaintext highlighter-rouge">:S=302</code>.<br />
Before I show the command I will also note that I knew the username was <code class="language-plaintext highlighter-rouge">fsociety</code> and had obtained a password list hidden on their site called <code class="language-plaintext highlighter-rouge">fsociety.dic</code>.<br /><br />
SO - putting all this together and knowing the syntax from above we get the following (semi-coherent) command:<br />
<code class="language-plaintext highlighter-rouge">hydra -l fsociety -P /home/wesleyvm1/Downloads/fsociety.dic 10.10.188.175 http-post-form "/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2F10.10.188.175%2Fwp-admin%2F&amp;testcookie=1:S=302</code><br />
<br />
It’s as simple as that. Even more simple is an ssh brute force, which I will cover below.<br /><br />
Quick note: To clarify the <code class="language-plaintext highlighter-rouge">:F=failed</code> scenario, basically if after attempting a login if that word (in this scenario “failed”) appears on the screen that indicates an <code class="language-plaintext highlighter-rouge">F</code>, or failure, so it will try again until it does not get the word “failed” on the page - i.e. a successful login.
<br /><br /><br /></p>
<h4 id="example-using-hydra-against-a-ssh-port">Example: Using hydra against a ssh port</h4>
<p>I forget the name of this CTF, but you’ll see how much more straightforward of an exploit this was.<br /><br />
What I knew going into this: the username was <code class="language-plaintext highlighter-rouge">lin</code> and I had obtained a possible password file named <code class="language-plaintext highlighter-rouge">locks.txt</code> anonymously from their ftp server.
<br /><br />
The final command ended up being as simple as:<br />
<code class="language-plaintext highlighter-rouge">hydra -t 4 -l lin -P /home/wesleyvm1/Downloads/locks.txt 10.10.180.91 ssh -v</code><br /><br />
And to see what a successful login looks like, this is what I (eventually) got:<br />
<img src="/assets/hydra1.jpg" alt="" /><br />
You can see for this instance I chose to incldue the <code class="language-plaintext highlighter-rouge">-t 4</code> flag to lower the default number of tasks and used the <code class="language-plaintext highlighter-rouge">-v</code> for verbose.<br /><br /><br /></p>

<h2 id="hash-identifier-hashid-and-john">Hash-identifier, hashid, and John</h2>
<p><br />
Okay, let’s say you get your hands on the /etc/shadow file or some other form of a hashed password, how do you go about identifying the hash before you can try and break it?<br />
For this, many distributions of linux should have a tool called “hash-identifier”. How it works is you simply type in <code class="language-plaintext highlighter-rouge">hash-identifier</code> in your terminal and that’ll start the program where you’ll be prompted to enter in the hash. Alternatively, you can use a tool called “hashid” which works very similar to the former, if you need help with this one just enter in <code class="language-plaintext highlighter-rouge">man hashid</code> or <code class="language-plaintext highlighter-rouge">hashid --help</code> for help figuring it out.
<br /><br />
Now using John to crack the hash. The first step is which <em>type</em> of hash are you cracking, for instance John lists at least 5 different forms of MD5 hashes. So to identify which one is the one to use with John, type in something along the lines of <code class="language-plaintext highlighter-rouge">john --list=formats | grep MD5</code>. This will give the different MD5 hash forms you can try. Once the format is chosen, you will need a password list to use, the default should almost always be the rockyou.txt file (reference <a href="/resources/freshinstall/">here</a> to get it), and if that doesn’t work you’ll likely have to branch out to other lists from SecLists.
<br /><br />
Now to setup an example brute force against a MD5 hash stored in the hash.txt file:<br />
<code class="language-plaintext highlighter-rouge">john --form=Raw-MD5 --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt</code><br />
<br />
Note: If you have already cracked a specific hash and deleted it, John will say it is already cracked if you try it again and then annoyingly not show you what it is. That cracked hash can be found in the john.pot file on your system. Since I don’t know where you’ll install John, you can find it with the following command:<br />
<code class="language-plaintext highlighter-rouge">find / -type f -name john.pot 2&gt;/dev/null</code><br />
<br />
Another note: Sometimes before attempting to crack a file you will need to convert it to a format that John can use. These tools are named things like “ssh2john” or “zip2john”, and since there are so many different kinds of formats out there, I’ll leave you to do your own research on each one specifically. Just know that before John can take a crack at certain file types there has to be some conversion made beforehand. There are a million forums online that will cover the how-to for ssh keys, zip password protected files, etc - what’s important is that you know these tools exist.<br />
<br /><br /></p>

<h2 id="other-means-of-breaking-hashes--encoded-files">Other means of breaking hashes / encoded files</h2>
<p>Even if you don’t know much about encoding / decoding you probably have heard the term “base64” at some point. To decode a file as simple as this just use:<br />
<code class="language-plaintext highlighter-rouge">cat filename.ext | base64 -d</code> and you can of course output the result to a file by adding <code class="language-plaintext highlighter-rouge">&gt; output.txt</code>
<br /><br /></p>

<h2 id="one-note-on-everyones-favorite-resource-online-tools">One note on everyone’s favorite resource… online tools</h2>
<p>To be fair, I do try and use John whenever possible to keep sharp on that skill, but I can be lazy and there are powerful online cracking tools out there. Sometimes it is tedious to go through the whole process of identifying the hash with a hash-identifer, it eventually tells you it is a raw MD5 hash, then you have to find the exact format for it in John with <code class="language-plaintext highlighter-rouge">john --list=formats | grep MD5</code> - where you eventually see <code class="language-plaintext highlighter-rouge">Raw-MD5</code> as an output, and then you finally run the command <code class="language-plaintext highlighter-rouge">john --format=Raw-MD5 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt</code>. What I’m saying is that sometimes it can be a tedious process, and plenty of online resources can save you that time and energy. Sites like <a href="https://crackstation.net/">crackstation</a> are one of many out there that can meet these needs, just make sure to stay proficient with John.
<br /></p>

</div>
                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">
        
        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
        </div>
    </div>
</footer>

    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>
</html>
