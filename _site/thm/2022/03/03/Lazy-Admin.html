<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TryHackMe - Lazy Admin | Wesley Kent</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="TryHackMe - Lazy Admin" />
<meta name="author" content="Wesley Kent" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TryHackMe - Lazy Admin" />
<meta property="og:description" content="TryHackMe - Lazy Admin" />
<link rel="canonical" href="http://localhost:4000/thm/2022/03/03/Lazy-Admin.html" />
<meta property="og:url" content="http://localhost:4000/thm/2022/03/03/Lazy-Admin.html" />
<meta property="og:site_name" content="Wesley Kent" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-03T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe - Lazy Admin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wesley Kent"},"dateModified":"2022-03-03T00:00:00-06:00","datePublished":"2022-03-03T00:00:00-06:00","description":"TryHackMe - Lazy Admin","headline":"TryHackMe - Lazy Admin","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/thm/2022/03/03/Lazy-Admin.html"},"url":"http://localhost:4000/thm/2022/03/03/Lazy-Admin.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                Wesley Kent
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">CTF Exploits</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/tipsandtricks/" class="navbar-link ">Tips and Tricks</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/tipsandtricks/bruteforcing/" class="navbar-item ">Brute forcing</a>
                            
                            <a href="/tipsandtricks/privilegeescalation/" class="navbar-item ">Privilege Escalation</a>
                            
                            <a href="/tipsandtricks/webstuff/" class="navbar-item ">Web Stuff</a>
                            
                            <a href="/tipsandtricks/usingnmap/" class="navbar-item ">Using Nmap</a>
                            
                            <a href="/tipsandtricks/steganography/" class="navbar-item ">Steganography</a>
                            
                            <a href="/tipsandtricks/defaultpayloads/" class="navbar-item ">Default payloads and msfconsole</a>
                            
                            <a href="/tipsandtricks/thebasics/" class="navbar-item ">The Basics</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/resources/" class="navbar-link ">Resources</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/resources/usefullinks" class="navbar-item ">Useful links</a>
                            
                            <a href="/resources/freshinstall" class="navbar-item ">Fresh Install</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/raspberrypi/" class="navbar-item ">Raspberry Pi Projects</a>
                    
                
                    
                    <a href="/femoldark/" class="navbar-item ">FE Moldark</a>
                    
                
                    
                    <a href="/contact/" class="navbar-item ">Contact</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-medium  is-bold is-primary"  style="background: url('/home/wesleyvm1/WesleyKentBlog/assets/default.png') no-repeat center center; background-size: cover;" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">TryHackMe - Lazy Admin</h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-8">
                    
                    
                    
                    
                    <div class="content">

    <p>Published: Mar 3, 2022 by Wesley Kent</p>

    

    <h1 id="tryhackme---lazy-admin">TryHackMe - Lazy Admin</h1>

<p>This CTF has two flags to find, let’s get into it with the most basic nmap scan available (honestly no idea why I didn’t include the <code class="language-plaintext highlighter-rouge">-sC -sV</code> flags here, I must’ve been tired):<br /></p>
<p align="center"><img width="600" src="/assets/blog/THM-Lazy-Admin/nmap.png" /></p>
<p>Since this is running an open port 80 and we can open it in a browser, let’s try to enumerate some more directories and pages:<br /></p>
<p align="center"><img width="850" src="/assets/blog/THM-Lazy-Admin/gobuster.png" /></p>
<p>There we discover the <code class="language-plaintext highlighter-rouge">/content</code> folder, which we can also run against our wordlist as well:<br /></p>
<p align="center"><img width="850" src="/assets/blog/THM-Lazy-Admin/gobusterII.png" /></p>
<p>This gives us a number of paths that we can investigate, and after a lot of searching I discovered a couple of interesting things, the most obvious being a login forum at <code class="language-plaintext highlighter-rouge">/as</code>:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/slash as.png" /></p>
<p>Now, knowing this CTF is titled “Lazy Admin”, I am going to assume that this admin is using poor usernames/passwords, or default ones. As such, I looked at the get request through burpsuite for the username/password input names and attempted to brute force a password for an ‘admin’ and other similar usernames with hydra. Unfortunately, since I was just guessing the username nothing came of it, but it was worth a try since I just let it run in the background.
<br /><br />
Moving on, in the <code class="language-plaintext highlighter-rouge">/inc</code> subfolder we do find an old mysql backup file, which are always good to find. Inside that we find some useful text, including the username and what appears to be a hashed password.<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/passwd.png" /></p>
<p>Now that we have found some kind of hashed password (in the above screenshot), we can try to crack it with John after identifying the hash type:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/hashidentifier.png" /></p>
<p>Now that we have the hash type, let’s run John against it:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/gottenpw.png" /></p>
<p>And we supposedly have a working user/pass, and trying to login on the <code class="language-plaintext highlighter-rouge">/as</code> site works. Also, from the backup sql file I now know that the username is actually ‘manager’, not the ‘admin’ I had previously guessed. Still a Lazy Admin choice, however, but moving on here is what we are greeted with after logging in:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/access.png" /></p>
<p>Now, after navigating around a bit there is a place where we can add an “ad”, which for me really meant I can just upload some custom code which may or may not accidentally start some kind of reverse shell.
<br /><br />
Again, a site that will prove very useful in these kinds of situations is pentestmonkey. After a quick ad upload test, we see the add runs as a php file, so let’s search pentestmonkey for an exploit that will work as that. The first option on there seems good enough, so let’s modify the script to our machine and set up a netcat listener.<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-Lazy-Admin/ad shell.png" /></p>
<p>From there, navigate to the site or curl the URL, whatever you want and our netcat listener should start a shell:<br /></p>
<p align="center"><img width="800" src="/assets/blog/THM-Lazy-Admin/got shell.png" /></p>
<p>It is simple enough to find the user flag, no different than any other box on THM. Now we do not have root access, but there is a way to get it with a quick <code class="language-plaintext highlighter-rouge">sudo -l</code> search:<br /></p>
<p align="center"><img width="800" src="/assets/blog/THM-Lazy-Admin/sudo l.png" /></p>
<p>We cannot edit this perl script directly, but we see that it runs a bash script, which we can check out. The “copy” script starts its own shell, all we have to do is edit in our own address and again another port with another listener to start a root shell for ourselves this time:<br /></p>
<p align="center"><img width="800" src="/assets/blog/THM-Lazy-Admin/get root.png" /></p>
<p>Once that happens, we’ll get a root shell in our other window and can easily get the root flag from there:<br /></p>
<p align="center"><img width="550" src="/assets/blog/THM-Lazy-Admin/root.png" /></p>
<p>And that is all for this box. Cheers,<br /><br />
Wes<br /></p>


</div>

<div class="tags">
    
</div>


<p><strong>Share</strong></p>
<div class="buttons ">
    <a class="button is-medium is-facebook"
       onclick="window.open('https://www.facebook.com/share.php?u=http://localhost:4000/thm/2022/03/03/Lazy-Admin.html');">
        <span class="icon"><i class="fab fa-facebook fa-lg"></i></span>
    </a>
    <a class="button is-medium is-twitter"
       onclick="window.open('https://twitter.com/intent/tweet?text=http://localhost:4000/thm/2022/03/03/Lazy-Admin.html');">
        <span class="icon"><i class="fab fa-twitter fa-lg"></i></span>
    </a>
    <a class="button is-medium is-linkedin"
       onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/thm/2022/03/03/Lazy-Admin.html&title=TryHackMe+-+Lazy+Admin&summary=&source=');">
        <span class="icon"><i class="fab fa-linkedin fa-lg"></i></span>
    </a>
    <a class="button is-medium is-reddit"
       onclick="window.open('https://reddit.com/submit?url=http://localhost:4000/thm/2022/03/03/Lazy-Admin.html');">
        <span class="icon"><i class="fab fa-reddit fa-lg"></i></span>
    </a>
</div>




                </div>
                
                <div class="column is-4-desktop is-4-tablet">
                    <p class="title is-4">Latest Posts</p>

<div class="columns is-multiline">
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/07/27/Brooklyn99.html">TryHackMe - Brooklyn Nine Nine</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---brooklyn-nine-nine">TryHackMe - Brooklyn Nine Nine</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/07/27/Brooklyn99.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Jul 27, 2022</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/06/11/BreakOutTheCage.html">TryHackMe - Break Out The Cage</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---break-out-the-cage">TryHackMe - Break Out The Cage</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/06/11/BreakOutTheCage.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Jun 11, 2022</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/05/26/Dav.html">TryHackMe - Dav</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---dav">TryHackMe - Dav</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/05/26/Dav.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: May 26, 2022</p>
    </footer>
</div>
    </div>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">
        
        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
        </div>
    </div>
</footer>

    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>
</html>
