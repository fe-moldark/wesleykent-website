<!DOCTYPE html>




<html
 dir="ltr"
 lang="en"
 >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content=#ffffff>
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="shortcut icon" type="image/png"
           href="/favicon.png" 
    />
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>TryHackMe - Simple SMTP Exploit | Wesley Kent</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="TryHackMe - Simple SMTP Exploit" />
<meta name="author" content="Wesley Kent" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Simple SMTP Exploit" />
<meta property="og:description" content="Simple SMTP Exploit" />
<link rel="canonical" href="http://localhost:4000/thm/2022/02/17/SMTP.html" />
<meta property="og:url" content="http://localhost:4000/thm/2022/02/17/SMTP.html" />
<meta property="og:site_name" content="Wesley Kent" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-17T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="TryHackMe - Simple SMTP Exploit" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Wesley Kent"},"dateModified":"2022-02-17T00:00:00-06:00","datePublished":"2022-02-17T00:00:00-06:00","description":"Simple SMTP Exploit","headline":"TryHackMe - Simple SMTP Exploit","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/thm/2022/02/17/SMTP.html"},"url":"http://localhost:4000/thm/2022/02/17/SMTP.html"}</script>
<!-- End Jekyll SEO tag -->

    <!-- head scripts --></head>

  <body>
    <nav class="navbar is-primary " x-data="{ openNav: false }">
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                Wesley Kent
            </a>
            <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navMenu" :class="{ 'is-active': openNav }" x-on:click="openNav = !openNav">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                
                    
                    <a href="/blog/" class="navbar-item ">CTF Exploits</a>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/tipsandtricks/" class="navbar-link ">Tips and Tricks</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/tipsandtricks/bruteforcing/" class="navbar-item ">Brute forcing</a>
                            
                            <a href="/tipsandtricks/privilegeescalation/" class="navbar-item ">Privilege Escalation</a>
                            
                            <a href="/tipsandtricks/webstuff/" class="navbar-item ">Web Stuff</a>
                            
                            <a href="/tipsandtricks/usingnmap/" class="navbar-item ">Using Nmap</a>
                            
                            <a href="/tipsandtricks/steganography/" class="navbar-item ">Steganography</a>
                            
                            <a href="/tipsandtricks/defaultpayloads/" class="navbar-item ">Default payloads and msfconsole</a>
                            
                            <a href="/tipsandtricks/thebasics/" class="navbar-item ">The Basics</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <div class="navbar-item has-dropdown is-hoverable ">
                        <a href="/resources/" class="navbar-link ">Resources</a>
                        <div class="navbar-dropdown">
                            
                            <a href="/resources/usefullinks" class="navbar-item ">Useful links</a>
                            
                            <a href="/resources/freshinstall" class="navbar-item ">Fresh Install</a>
                            
                        </div>
                    </div>
                    
                
                    
                    <a href="/raspberrypi/" class="navbar-item ">Raspberry Pi Projects</a>
                    
                
                    
                    <a href="/femoldark/" class="navbar-item ">FE Moldark</a>
                    
                
                    
                    <a href="/contact/" class="navbar-item ">Contact</a>
                    
                
                    
                    <a href="/about/" class="navbar-item ">About</a>
                    
                
                
            </div>

            <div class="navbar-end">
                
            </div>

        </div>
    </div>
</nav>

    
        <section class="hero  is-medium  is-bold is-primary"  style="background: url('/home/wesleyvm1/WesleyKentBlog/assets/default.png') no-repeat center center; background-size: cover;" >
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2">TryHackMe - Simple SMTP Exploit</h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>
    
    


    <section class="section">
        <div class="container">
            <div class="columns is-multiline">
                
                <div class="column is-8">
                    
                    
                    
                    
                    <div class="content">

    <p>Published: Feb 17, 2022 by Wesley Kent</p>

    

    <h1 id="simple-smtp-exploit">Simple SMTP Exploit</h1>

<p>As you might’ve guessed, Simple Mail Transfer Protocol or SMTP deals with the sending emails. Since we already know this box deals with SMTP and we know what the default port for it is, let’s try a targeted scan for time’s sake:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-SMTP/nmap scan.png" /></p>
<p>Thankfully the TryHackMe guys kept SMTP running over its default port.
<br /><br />
Starting up msfconsole we can quickly locate a <code class="language-plaintext highlighter-rouge">smtp_version</code> script to give a go:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-SMTP/msfconsole.png" /></p>
<p>Let’s go ahead and use option 0 (the only option) and then <code class="language-plaintext highlighter-rouge">show options</code>. We need to configure the <code class="language-plaintext highlighter-rouge">rhosts</code> and <code class="language-plaintext highlighter-rouge">rport</code> to the box’ IP and the port running SMTP. After running the exploit, we see the following from our auxiliary scan:<br /></p>
<p align="center"><img width="700" src="/assets/blog/THM-SMTP/msfconsole2.png" /></p>
<p>For the TryHackMe lesson it asks for the system mail name, which we can see is <code class="language-plaintext highlighter-rouge">polosmtp.home</code> from the scan above. Funnily enough, I realized we already got this information from our initial nmap scan running with the <code class="language-plaintext highlighter-rouge">-sC</code> and <code class="language-plaintext highlighter-rouge">-sV</code> flags.
<br /><br />
It then asks for the MTA, or Message Transfer Agent, whose purpose is in its very name, just for the SMTP protocol. This answer can also be found from the auxiliary scan.
<br /><br />
This next part requires us to enumerate the users. I first tried this with an nmap script called <code class="language-plaintext highlighter-rouge">smtp-enum-users.nse</code> hoping it would be as simple as that, but didn’t get anything from it. Msfconsole does have a similar script it can run, however, called <code class="language-plaintext highlighter-rouge">smtp_enum</code>.
<br /><br />
After loading that up in the console, we need to set a few options including choosing a wordlist if we don’t like or don’t want their default. If you don’t already have SecLists by danielmiessler downloaded, it is a must. Under <code class="language-plaintext highlighter-rouge">/SecLists/Usernames</code> there are a lot of useful options to chose from.
<br /><br />
After everything is properly configured, go ahead and run this next auxiliary. You should get back the following:<br /></p>
<p align="center"><img width="800" src="/assets/blog/THM-SMTP/second msfconsole script.png" /></p>
<p>You’ll see the SMTP server running a user with the very original and very secure name of <code class="language-plaintext highlighter-rouge">administrator</code>. Now that we have a username, let’s see what we can do in terms of gaining access via ssh.</p>

<p>As I’ve used hydra in previous posts I won’t get too much detail about it, but understanding the syntax is important. Let’s get the hydra command set up and running:<br /></p>
<p align="center"><img width="800" src="/assets/blog/THM-SMTP/hydra ssh.png" /></p>
<p>This should eventually reveal valid login credentials that we can use to ssh into this machine:<br /></p>
<p align="center"><img width="650" src="/assets/blog/THM-SMTP/final image.png" /></p>
<p>And we can get the flag as easy as that. Cheers,<br /><br />
Wes<br /></p>


</div>

<div class="tags">
    
</div>


<p><strong>Share</strong></p>
<div class="buttons ">
    <a class="button is-medium is-facebook"
       onclick="window.open('https://www.facebook.com/share.php?u=http://localhost:4000/thm/2022/02/17/SMTP.html');">
        <span class="icon"><i class="fab fa-facebook fa-lg"></i></span>
    </a>
    <a class="button is-medium is-twitter"
       onclick="window.open('https://twitter.com/intent/tweet?text=http://localhost:4000/thm/2022/02/17/SMTP.html');">
        <span class="icon"><i class="fab fa-twitter fa-lg"></i></span>
    </a>
    <a class="button is-medium is-linkedin"
       onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/thm/2022/02/17/SMTP.html&title=TryHackMe+-+Simple+SMTP+Exploit&summary=&source=');">
        <span class="icon"><i class="fab fa-linkedin fa-lg"></i></span>
    </a>
    <a class="button is-medium is-reddit"
       onclick="window.open('https://reddit.com/submit?url=http://localhost:4000/thm/2022/02/17/SMTP.html');">
        <span class="icon"><i class="fab fa-reddit fa-lg"></i></span>
    </a>
</div>




                </div>
                
                <div class="column is-4-desktop is-4-tablet">
                    <p class="title is-4">Latest Posts</p>

<div class="columns is-multiline">
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/07/27/Brooklyn99.html">TryHackMe - Brooklyn Nine Nine</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---brooklyn-nine-nine">TryHackMe - Brooklyn Nine Nine</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/07/27/Brooklyn99.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Jul 27, 2022</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/06/11/BreakOutTheCage.html">TryHackMe - Break Out The Cage</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---break-out-the-cage">TryHackMe - Break Out The Cage</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/06/11/BreakOutTheCage.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: Jun 11, 2022</p>
    </footer>
</div>
    </div>
    
    <div class="column is-12">
        <div class="card">
    
    <header class="card-header">
        <a class="card-header-title" href="/thm/2022/05/26/Dav.html">TryHackMe - Dav</a>
    </header>
    
    <div class="card-content">
        <div class="content">
            
            
                <p><h1 id="tryhackme---dav">TryHackMe - Dav</h1>
</p>
            
        </div>
        <div class="has-text-centered">
            <a href="/thm/2022/05/26/Dav.html" class="button is-primary">Read more</a>
        </div>
    </div>
    <footer class="card-footer">
        <p class="card-footer-item">Published: May 26, 2022</p>
    </footer>
</div>
    </div>
    
</div>




                </div>
                
            </div>
        </div>
    </section>
    
        <footer class="footer">
    <div class="container">
        
        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
        </div>
    </div>
</footer>

    
    <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts --></body>
</html>
